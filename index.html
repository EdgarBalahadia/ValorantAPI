<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Valorant Agents</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <style>
    :root{
      --page-bg: #0b1220;
      --card-bg: #0f1724;
      --accent: #7c3aed;
      --muted: #9ca3af;
    }
    body{
      background: linear-gradient(180deg, var(--page-bg) 0%, #071025 100%);
      color: #e6eef8;
      min-height: 100vh;
    }
    .site-header{
      background-color: #0b1220;
      border-bottom: 1px solid rgba(255,255,255,0.03);
    }
    .site-title{ color: #fff; }
    .card.val-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: none;
      color: #f3f7fb;
    }
    .agent-circle{
      width: 200px;
      height: 200px;
      border-radius: 50%;
      overflow: hidden;
    }
    .agent-circle img{ object-fit: cover; height: 100%; }
    .abilities-row img{
      width: 48px;
      height: 48px;
      object-fit: contain;
    }
    .abilities-row .btn{
      background: transparent;
      border: none;
      padding: 4px;
      color: inherit;
    }
    .page-indicator{ color: var(--muted); }
    footer.site-footer{
      background: #071021;
      color: var(--muted);
      padding: 1rem 0;
      border-top: 1px solid rgba(255,255,255,0.03);
    }
    @media (max-width: 576px){
      .agent-circle{ width: 140px; height: 140px; }
      .card.p-5{ padding: 1.5rem !important; }
      .h3{ font-size: 1.25rem; }
    }
    @media (min-width: 577px) and (max-width: 992px){
      .agent-circle{ width: 160px; height: 160px; }
    }
  </style>
</head>
<body>
  <div class="container-fluid site-header sticky-top">
    <div class="row p-3 align-items-center">
      <div class="col">
        <div class="h4 site-title">
          Valorant Agents
        </div>
      </div>
      <div class="col text-end">
        <a href="index.html"><button class="btn btn-outline-light">Back</button></a>
      </div>
    </div>
  </div>

  <div class="container my-3">
    <div class="row">
      <div class="col">
        <nav aria-label="Page navigation">
          <ul class="pagination">
            <li class="page-item">
              <a class="page-link" aria-label="Previous" onclick="prevPage()">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" aria-label="Next" onclick="nextPage()">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
      <div class="col text-end align-self-center">
        <div id="pageText" class="page-indicator">Page 1</div>
      </div>
    </div>
  </div>

  <div class="container my-1">
    <div class="row" id="contentArea"></div>
  </div>

  <footer class="site-footer mt-4">
    <div class="container">
      <div class="row">
        <div class="col text-center small">
          Built with data from the Valorant API · Design inspired by the course Pokédex
        </div>
      </div>
    </div>
  </footer>

  <div class="modal fade" id="abilityModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="abilityModalTitle"></h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="abilityModalBody"></div>
        <div class="modal-footer border-0">
          <img id="abilityModalIcon" src="" alt="" style="width:56px;height:56px;object-fit:contain;">
        </div>
      </div>
    </div>
  </div>

  <script>
    const colors = { duelist: '#FFDDE6', initiator: '#DDEBFF', controller: '#E6DFFF', sentinel: '#DFF7E0', unknown: '#F5F5F5' };
    const contentArea = document.getElementById("contentArea");
    const pageText = document.getElementById("pageText");
    let agents = [];
    let page = 1;
    let pageSize = 10;

    function prevPage(){
      if (page > 1) { page--; pageText.innerHTML = "Page " + page; contentArea.innerHTML = ""; renderPage(); }
    }

    function nextPage(){
      const maxPage = Math.ceil(agents.length / pageSize) || 1;
      if (page < maxPage) { page++; pageText.innerHTML = "Page " + page; contentArea.innerHTML = ""; renderPage(); }
    }

    function renderPage(){
      const start = (page - 1) * pageSize;
      const end = page * pageSize;
      for (let i = start; i < end; i++){
        const agent = agents[i];
        if (!agent) continue;
        const name = agent.displayName || 'Unknown';
        const role = (agent.role && agent.role.displayName) ? agent.role.displayName : 'Unknown';
        const roleKey = role.toLowerCase();
        const picture = agent.displayIcon || agent.displayIconSmall || '';
        const bg = colors[roleKey] || colors['unknown'];
        const abilities = agent.abilities || [];
        let abilitiesHtml = '';
        for (let a = 0; a < abilities.length; a++){
          const abl = abilities[a];
          const icon = abl.displayIcon || '';
          const btnId = 'btn-' + i + '-' + a;
          abilitiesHtml += '<button id="'+btnId+'" class="btn" onclick="showAbility('+i+','+a+')" title="'+(abl.displayName||'')+'">'+(icon?'<img src="'+icon+'" alt="">':'<div class="small px-2">'+(abl.displayName||'')+'</div>')+'</button>';
        }
        contentArea.innerHTML +=
        '<div class="col-12 col-md-6 col-lg-4">'+
          '<div class="card val-card p-5 rounded-5 my-4 text-center shadow-sm">'+
            '<div class="agent-circle mx-auto" style="background-color:'+bg+'; display:flex; align-items:center; justify-content:center;">'+(picture?'<img src="'+picture+'" alt="'+name+'">':'<div class="h5">'+name+'</div>')+'</div>'+
            '<div class="h3 my-3">'+name+'</div>'+
            '<div class="mt-3 px-5"><div class="border rounded-5 p-2" style="background-color:'+bg+'">'+role+'</div></div>'+
            '<div class="mt-3 d-flex justify-content-center abilities-row">'+abilitiesHtml+'</div>'+
          '</div>'+
        '</div>';
      }
    }

    async function getAgents(){
      try {
        const res = await fetch('https://valorant-api.com/v1/agents');
        if (!res.ok) throw new Error(res.status);
        const json = await res.json();
        agents = (json.data || []).filter(a => a.isPlayableCharacter);
        agents.sort((a,b) => (a.displayName||'').localeCompare(b.displayName||''));
        page = 1;
        pageText.innerHTML = "Page " + page;
        contentArea.innerHTML = "";
        renderPage();
      } catch (err) {
        contentArea.innerHTML = '<div class="col-12"><div class="alert alert-danger">Could not load agents. See console for details.</div></div>';
        console.error(err);
      }
    }

    function showAbility(agentIndex, abilityIndex){
      const agent = agents[agentIndex];
      if (!agent) return;
      const ability = (agent.abilities||[])[abilityIndex];
      if (!ability) return;
      const modalTitle = document.getElementById('abilityModalTitle');
      const modalBody = document.getElementById('abilityModalBody');
      const modalIcon = document.getElementById('abilityModalIcon');
      modalTitle.textContent = ability.displayName || '';
      modalBody.textContent = ability.description || 'No description available.';
      modalIcon.src = ability.displayIcon || '';
      const modalEl = new bootstrap.Modal(document.getElementById('abilityModal'));
      modalEl.show();
    }

    getAgents();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>