<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Valorant Agents</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>

<body>
  <div class="container-fluid" style="background-color: #1f2937;">
    <div class="row p-3">
      <div class="col">
        <div class="h3 text-light">
          Valorant Agents
        </div>
      </div>
      <div class="col text-end">
        <a href="index.html">
          <button class="btn btn-secondary">Back</button>
        </a>
      </div>
    </div>
  </div>

  <div class="container my-3">
    <div class="row">
      <div class="col">
        <nav aria-label="Page navigation example">
          <ul class="pagination">
            <li class="page-item">
              <a class="page-link" aria-label="Previous" onclick="prevPage()">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" aria-label="Next" onclick="nextPage()">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col">
        <div id="pageText">
          Page 1
        </div>
      </div>
    </div>
  </div>

  <div class="container my-1">
    <div class="row" id="contentArea">
    </div>
  </div>

  <script>
    const colors = {
      duelist: '#FFDDE6',
      initiator: '#DDEBFF',
      controller: '#E6DFFF',
      sentinel: '#DFF7E0',
      unknown: '#F5F5F5'
    };

    var contentArea = document.getElementById("contentArea");
    var pageText = document.getElementById("pageText");

    var agents = [];
    var page = 1;
    var pageSize = 10;

    function prevPage(){
      if (page > 1) {
        page--;
        pageText.innerHTML = "Page " + page;
        contentArea.innerHTML = "";
        renderPage();
      }
    }

    function nextPage(){
      var maxPage = Math.ceil(agents.length / pageSize) || 1;
      if (page < maxPage) {
        page++;
        pageText.innerHTML = "Page " + page;
        contentArea.innerHTML = "";
        renderPage();
      }
    }

    function renderPage() {
      var start = (page - 1) * pageSize;
      var end = page * pageSize;

      for (var i = start; i < end; i++) {
        var agent = agents[i];
        if (!agent) continue;

        var name = agent.displayName || 'Unknown';
        var role = (agent.role && agent.role.displayName) ? agent.role.displayName : 'Unknown';
        var roleKey = role.toLowerCase();
        var id = agent.uuid || '';
        var picture = agent.displayIcon || agent.displayIconSmall || '';

        var bg = colors[roleKey] || colors['unknown'];

        contentArea.innerHTML +=
        '<div class="col-12 col-md-6 col-lg-4">' +
          '<div class="card p-5 rounded-5 my-4 text-center">' +
            '<div style="width: 200px; height: 200px; background-color: ' + bg + '" class="rounded-circle mx-auto d-flex align-items-center justify-content-center overflow-hidden">' +
              (picture ? '<img class="w-100" src="' + picture + '">' : '') +
            '</div>' +
            '<div class="h3 my-3">' +
              name +
            '</div>' +
            '<div class="mt-3 px-5">' +
              '<div class="border rounded-5 p-2" style="background-color: ' + bg + '">' +
                role +
              '</div>' +
            '</div>' +
          '</div>' +
        '</div>';
      }
    }

    async function getAgents() {
      try {
        var res = await fetch('https://valorant-api.com/v1/agents');
        if (!res.ok) throw new Error('Network response was not ok: ' + res.status);
        var json = await res.json();

        agents = (json.data || []).filter(function(a) {
          return a.isPlayableCharacter;
        });

        agents.sort(function(a, b) {
          return (a.displayName || '').localeCompare(b.displayName || '');
        });

        page = 1;
        pageText.innerHTML = "Page " + page;
        contentArea.innerHTML = "";
        renderPage();
      } catch (err) {
        console.error('Fetch error:', err);
        contentArea.innerHTML = '<div class="col-12"><div class="alert alert-danger">Could not load agents. See console for details.</div></div>';
      }
    }

    getAgents();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>
</body>

</html>